---{ PSUEDO-CODE }---
=IF(
    AND(
        ADDRESS = ROM_ADDRESS,
        END_PROGRAM_FLAG != 1
    ),
    IF(ROM_ADDRESS != END_PROGRAM_TOKEN,
        ROM_ADDRESS,
        WRITE_TO_CELL(END_PROGRAM_FLAG, 1)
    ),
    ADDRESS
)

--{ WRITE_TO_CELL VBA MACRO }---
https://superuser.com/a/602928